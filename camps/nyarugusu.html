<!DOCTYPE html>
<html>
<head>
    <title>Nyaragosu</title>

    <link href="https://fonts.googleapis.com/css?family=Hind+Siliguri&display=swap" rel="stylesheet"> 
    <link href="https://fonts.googleapis.com/css?family=Buenard|Lustria|Vollkorn&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
    <link rel="shortcut icon" href="../tweets/assets/nglogo.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="../css/master.css" />
    <link rel="stylesheet" href="css/camps.css" />
    <link rel="stylesheet" href="../css/perfect-scrollbar.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.js"></script>
    <script src="../tweets/js/utils.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="  crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        html {
        -moz-osx-font-smoothing: grayscale;
        -webkit-font-smoothing: antialiased;
        font-weight: 400;
        }
    
     @-moz-document url-prefix() {
         body {
             font-weight: lighter !important;
         }
     }
        body {
            padding: 0;
            margin: 0;
        }
        html, body, #map {
            height: 100%;
        }
        .lorem {
            font-style: italic;
            color: #AAA;
        }
        .leaflet-marker-icon,
        .leaflet-marker-shadow {
            opacity: 0;
        }
        h5 {
            margin: 0;
        }
        h1{
      margin-top: 10px!important;
    }
    </style>
</head>
<body>
    <div class="navBar">
        <a href="../camp_menu.html" class="back"><i class="fa fa-chevron-left"></i></a>
        <a href="../index.html" class="home">Global Refugee Atlas</a>
        <a href="https://facebook.com" target="_blank" class="fb"><i class="fa fa-facebook"></i></a>
        <a href="https://twitter.com" target="_blank" class="tw"><i class="fa fa-twitter"></i></a>
        <a href="https://github.com/jakobzhao/refugee" target="_blank" class="github"><i class="fa fa-github"></i></a>
      </div>
    <div class="row">
    <div id="infoPanel" class="col-md-3">
            <img id="ng" src="../assets/img/camp_icon.png"></a>
        <h1>NYARUGUSU</h1> 
        <p>
            <div id="text">
                <h2 style="display: inline-block;">Population: </h2>&nbsp;<h2 id="pop" style="display: inline-block;">65,000</h2><br>
                <p style="display: inline-block;">Last updated: </p>&nbsp;<p id="updated" style="display: inline-block;">null</p>
                <div class="legend_container" id="leg_1">
                    <p><a href="https://reliefweb.int/sites/reliefweb.int/files/resources/65654.pdf" target = "_blank"style="display: inline-block; color: lightblue;">Nyaragosu refugee camp </a> was opened in November 1996 to host Persons of Concern fleeing conflicts in DRC. Prior to April 2015, the camp hosted 65,000 Congolese and 2,400 Burundians. 84,961 Burundians arrived between April and October 2015 were being hosted in Nyarugusu refugee camp before relocation of close to 40,000 Burundian refugees to <a href="nduta.html" style="display: inline-block; color: silver;">Nduta </a> and <a href="mtendeli.html"style="display: inline-block; color: silver;">Mtendeli </a> refugee camps between October 2015 and February 2016 respectively. The camp is currently performing a resettlement process that is mainly targeting Congolese who arrived in Tanzania between 1994 and 2005.
                    </p>  
                    <p style="display: inline-block;">Number of Refugees in  &nbsp;<a href="https://data2.unhcr.org/en/situations/burundi/location/2036" target = "_blank"style="display: inline-block; color: lightblue;">Nyarugusu</a></p>
                    <p>    <div id="mycanvas">
                            <canvas id="canvas" width="900" height="600" ></canvas>
                           </div>
                    </p>
                    <p style="display: inline-block;">Country of Origin of Refugees in &nbsp;<a href="https://reliefweb.int/report/united-republic-tanzania/united-republic-tanzania-inter-agency-operational-update-june-2019" target="_blank" style="display: inline-block; color: lightblue;">Tanzania</a></p>
                    <p>    <div id="mycanvas">
                            <canvas id="canvas2" width="900" height="600" ></canvas>
                           </div>
                    </p>
                    <p>
                        .
                    </p>
                   
                </div>
            </div>
        </p>
    </div>

    <div id="map" class="col-md-9"></div>
</div>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.10/js/bootstrap-select.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js"></script>
    <script src="../js/perfect-scrollbar.js"></script>
    <script src="../js/L.Control.Sidebar.js"></script>
    <script src="../js/leaflet-timeline-slider.js"></script>
    <script src="../js/chart.js"></script>
    <script src="../js/Chart.PieceLabel.min.js"></script>
    <!--miniglobe libs-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
    <script src="js/Control.GlobeMiniMap.js"></script>    <script>
        const ps = new PerfectScrollbar('#text', {
            wheelSpeed: .1,
            wheelPropagation: true,
            minScrollbarLength: 20
          });
    </script>
    <script>
            window.onload = function(){
            $.getJSON("https://data2.unhcr.org/api/population/get?widget_id=55527&geo_id=856&sv_id=13&population_collection=12", function() {
                
            }).then(function(data) {
    
                var population = (Number(data.data[0].individuals)).toLocaleString()
                var update = (data.data[0].date)
               
            document.getElementById('pop').innerHTML = population;
            document.getElementById('updated').innerHTML = update;
             })
            };
        </script>
    <script>
        var map = L.map('map', {
                minZoom: 13,
                maxZoom: 14,
                zoomControl:false,
                attributionControl:false
            });
        map.setView([-4.23, 30.38], 13);
        L.control.scale({                
                position: 'bottomright'
            }).addTo(map);
        var google_2018 = L.tileLayer('https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
                    
            }).addTo(map);

            data = {"type": "FeatureCollection",
                        "features": [
                        {
                                "type": "Feature",
                                "properties": {
                                    "title": "12/2014",
                                    "base": "https://storage.googleapis.com/geeovanni/nat_geo/nyaragosu_2014/{z}/{x}/{y}"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        92.15,
                                        21.20,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "12/2015",
                                    "base": "https://storage.googleapis.com/geeovanni/nat_geo/nyaragosu_2015/{z}/{x}/{y}"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        92.15,
                                        21.20,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "12/2016",
                                    "base": "https://storage.googleapis.com/geeovanni/nat_geo/nyaragosu_2016/{z}/{x}/{y}"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        92.15,
                                        21.20,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "12/2017",
                                    "base": "https://storage.googleapis.com/geeovanni/nat_geo/nyaragosu_2017/{z}/{x}/{y}"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        92.15,
                                        21.20,
                                        1
                                    ]
                                }
                            },
                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "12/2018",
                                    "base": "https://storage.googleapis.com/geeovanni/nat_geo/nyaragosu_2018/{z}/{x}/{y}"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        92.15,
                                        21.20,
                                        1
                                    ]
                                }
                            },

                            {
                                "type": "Feature",
                                "properties": {
                                    "title": "09/2019",
                                    "base": "https://storage.googleapis.com/geeovanni/nat_geo/nyaragosu_2019/{z}/{x}/{y}"
                                },
                                "geometry": {
                                    "type": "Point",
                                    "coordinates": [
                                        92.15,
                                        21.20,
                                        1
                                    ]
                                }
                            
                            },

                        ]
                    }


            getDataAddMarkers = function( {label, map, base} ) {
                map.eachLayer(function (layer) {
                        if (layer instanceof L.Marker) {
                            map.removeLayer(layer);                            
                        }
                });

                filteredData = data.features.filter(function (i, n) {
                    return i.properties.title===label;                   
                    });

                var markerArray = [];
                L.geoJson(filteredData, {
                    onEachFeature: function onEachFeature(feature, layer) { 
                        var pippo = feature.properties.base
                        L.tileLayer(pippo).addTo(map);                        
                        markerArray.push(layer);
                    }
                }).addTo(map);
                
                var markerGroup = L.featureGroup(markerArray);
                // map.fitBounds(markerGroup.getBounds()).setZoom(13);
               
            };
            function addControlPlaceholders(map) {
                var corners = map._controlCorners,
                    l = 'leaflet-',
                    container = map._controlContainer;

                function createCorner(vSide, hSide) {
                    var className = l + vSide + ' ' + l + hSide;

                    corners[vSide + hSide] = L.DomUtil.create('div', className, container);
                }

                createCorner('verticalcenter', 'left');
                createCorner('verticalcenter', 'right');
            }

            addControlPlaceholders(map);

            var timeline = L.control.timelineSlider({
                position:"verticalcenterright",
                timelineItems: ["12/2014", "12/2015", "12/2016", "12/2017",  "12/2018", "09/2019"], 
                changeMap: getDataAddMarkers,
                extraChangeMapParams: {} })
            .addTo(map);  
            new L.Control.Zoom({ position: 'topright' }).addTo(map);
            new L.Control.GlobeMiniMap({
                marker: 'red',
                position: 'bottomright'
            }).addTo(map);
    </script>
    <script>
        Chart.defaults.global.defaultFontFamily = "Roboto Condensed";
        var refugees =[3761, 86477,63863, 69280, 70140, 65090]
        var arrDate = ['2014','2015', '2016', '2017', '2018', '2019']
        // $.getJSON("https://data2.unhcr.org/api/population/get/timeseries?widget_id=55528&geo_id=856&sv_id=13&population_collection=12&frequency=day&fromDate=2015-04-01", function(data) {
        
        // }).then(function(data) {

        // $.each( data, function(i) {
        //     refugees.push(data.data.timeseries[0].individuals);
        //     arrDate.push(data.data.timeseries[0].data_date);
        //     });
        var utils = Samples.utils;
        var presets = window.chartColors;
      
        var ctx = document.getElementById('canvas').getContext("2d"); 
        var myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: arrDate,
                datasets: [{
                    label: "",
                    backgroundColor: utils.transparentize(presets.blue),
					borderColor: presets.blue,
                    data: refugees
                }]
            },
            options: {
                title: {
                    display: false,
                    text: ''
                    
                },
                legend: {
                    display: false
                },
                scales: {
                    yAxes: [{
                        ticks: {
                            fontColor: "rgba(255,255,255,0.9)",
                            // fontStyle: "bold",
                            fontFamily: 'Roboto Condensed', 
                            beginAtZero: true,
                            maxTicksLimit: 5,
                            padding: 20
                        },
                        gridLines: {
                            drawTicks: false,
                            display: false,
                            color: "rgba(255,255,255,0.05)",
                        }
                    }],
                    xAxes: [{
                        gridLines: {
                            zeroLineColor: "transparent",
                            color: "rgba(255,255,255,0.5)",
                        },
                        ticks: {
                            padding: 20,
                            fontColor: "rgba(255,255,255,0.9)",
                            // fontStyle: "bold"
                        }
                    }]
                }
            }
        });
        // });
    </script>
    <script>
		var ctx2 = document.getElementById('canvas2').getContext("2d");

        var myChart2 = new Chart(ctx2, {
            type: 'pie',
			data: {
				datasets: [{
					data: [
						228384,79463
					],
					backgroundColor: [
						window.chartColors.blue,
						window.chartColors.orange,
					],
					label: 'Dataset 1'
				}],
				labels: [
					'Burundi',
					'DRC',

				]
			},
			options: {
                responsive: true,
                title: {
                    display: false,
                    
                    
                },
                legend: {
                    display: true,
                    labels:{fontColor: "rgba(255,255,255,0.9)"},
                },

			}
		});

    </script> 
</body>
</html>